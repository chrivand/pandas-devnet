# Hands-on excercise: Calculate average bytes per flow
In the previous step, you imported a file and created a pandas DataFrame using the file. In this step, we are going to take it a step further and calculate the average bytes per flow.

## Objectives

After this lab, you should be able to:

* Parse a pandas DataFrame
* Change the `dtype` of a DataFrame column
* Calculate the average of a DataFrame column


## Let's continue with writing our code

In this DataFrame, we have three columns about the number of bytes per flow. The `Subject Bytes` are the number of bytes flowing from the _source_, the `Peer Bytes` are the numbers of bytes flowing from the _destination_, and the `Total Bytes` are the total numbers of bytes flowing from the _source_ and the _destination_. Moreover, we can observe that the _dtype_ of these columns are _object_, i.e., a string, but in order to compute averages, we need to convert the dtype to a _numeric_ type, e.g,. `int64`. 

1. Let's write a function that can convert a string to a numeric value. Moreover, if there is a metric prefix, e.g., _K_ or _M_, then these can be converted to numerics as well. 

    ```python
        def text_to_num(text, bad_data_val = 0):
            letter_to_number_dict = {
                'K': 1000,
                'M': 1000000,
                'B': 1000000000
            }
            if not isinstance(text, str):
                # Non-strings are bad are missing data in poster's submission
                return bad_data_val
            elif '--' in text:
                return bad_data_val
            elif text[-1] in letter_to_number_dict:
                # separate out the K, M, or B
                num, letter = text[:-2], text[-1]
                return int(float(num) * letter_to_number_dict[letter])
            else:
                return float(text)
    ```

2. We can apply this function to an entire column of the DataFrame using the built-in method `apply()`. 

    ```python
        df['Total Bytes'] =  df['Total Bytes'].apply(text_to_num)
    ```
    After applying the `text_to_num()` function to the entire column, we replace the previous column with the new column. 

    Now, all the strings are replaced with numeric values. 

3. In the last step, we are going to calculate the average bytes per flow. Fortunately, there is a built-in method that can calculate the average of the entire column. 
    ```python
    df['Total Bytes'].mean()
    ```
    For the average bytes per flow, we obtain an average of 589kB per flow. 


**Next Step: Hands-on excercise: calculate average bytes per flow per host group**